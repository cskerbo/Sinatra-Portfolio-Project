<link rel="stylesheet" type="text/css" href="/css/build.css">
<!--LINK JQUERY-->
<body>
<form name="build" onsubmit="return validatePerks() && validateForm();" action="/build/<%=@build.id %>" method="POST">
  <input type="hidden" name="_method"  id="hidden" value="patch">
  <div class="container">
    <div class="character-content">
      <div class="cs-how">
        <h1>Editing build: <span style="color: red"><%=@build.name %></span></h1>
        <h3>Build Type: <%=@build.build_type.capitalize %></h3>
        <h3>Date Created: Placeholder</h3>
        <h3>Last Edited: Placeholder</h3>
        <h3>Keep your existing build name, or enter a new one:</h3><br>
        <input type="text" name="build[name]" id="build-name" value="<%=@build.name%>" placeholder="ex. Stealth, Healing, Looping, My Favorite Build"><br>
        <div class="buttons">
        <button id="submit" type="submit">Save</button>
        <button id="submit" formaction="/build/<%=@build.id %>/delete" formmethod="get">Delete</button>
        <button id="submit" formaction="/user_builds" formmethod="get">Cancel</button>
        </div>
        <div class="build-character">
          <p>Placeholder for character info</p>
        </div>
      </div>
      <div class="container-characters">
        <div class="fpbox" id="fpsurvivors" style="text-align: center;">
          <div class="heading">Current Build</div>
          <div class="fplinks" id="loadout">
            <div class="build">
              <%counter = 1 %>
            <% @build.perks.each do |p|%>
                  <div id="perk<%counter %>-container" class="perk-container" onchange="handlePerkChange('<%=counter %>');">
                    <div class="perk-selection">
                    <h3>Slot <%=counter %></h3>
                    <select class="select-css" id="perk<%=counter %>-select-list" name="build[perk_ids][]">
                      <option value="none">Empty - Select a Perk</option>
                      <%@perks.each do |m| %>
                        <% if m.role == @build.build_type%>
                          <%if m.name == p.name %>
                          <option value="<%=m.id %>" selected="selected"><%=m.name %></option>
                          <%else%>
                      <option value="<%=m.id %>"><%=m.name %></option>
                            <%end %>
                          <%end %>
                        <%end %>
                    </select>
                    </div>
                    <div id="perk<%=counter %>-description" class="perk-slot"></div>
                  </div>
                    <%counter += 1 %>
              <%end%>
              <!-- creates empty perks slots in the event the build has less than 4 perks attached -->
              <%if @build.perks.count < 4 %>
              <% counter = @build.perks.count%>
              <%while counter < 4 %>
                  <%counter += 1 %>
                <div id="perk<%counter %>-container" class="perk-container" onchange="handlePerkChange('<%=counter %>');">
                  <div class="perk-selection">
                    <h4>Slot <%=counter %></h4>
                    <select class="select-css" id="perk<%=counter %>-select-list" name="build[perk_ids][]">
                      <option value="none" selected="selected">Select a perk</option>
                      <%@perks.each do |m| %>
                        <% if m.role == @build.build_type%>
                            <option value="<%=m.id %>"><%=m.name %></option>
                          <%end %>
                        <%end %>
                    </select>
                  </div>
                  <div id="perk<%=counter %>-description" class="perk-slot"></div>
                </div>
              <%end%>
              <%end%>
                </div>
                <br>
              </div>
            </div>
          </div>
        </div>
      </div>
</form>
</body>